export ZSH_HOME=~/.zsh

export VISUAL=nvim
export EDITOR=nvim

# executable search path (last to first order)
PATHS=(
  /usr/local/bin
  /usr/local/sbin
  /home/linuxbrew/.linuxbrew/bin
  /home/linuxbrew/.linuxbrew/sbin
  $HOME/.local/bin
  $HOME/Library/Python/3.7/bin
)
for p in $PATHS; do
  if (test -d $p); then
    export PATH="$p:$PATH"
  fi
done

# Setup DEFAULT_USER for the theme
USER=`whoami`
if [ $USER = 'tapayne88' ] ||
   [ $USER = 'tpayne' ] ||
   [ $USER = 'tpa11' ]; then
    DEFAULT_USER=$USER
fi

# Disables scroll lock shortcut (Ctrl+s)
stty -ixon
KEYTIMEOUT=1

# fzf defaults
export FZF_DEFAULT_COMMAND="ag --nocolor -g ''"
export FZF_CTRL_T_COMMAND="ag --nocolor -g ''"
export FZF_TMUX=1
export FZF_TMUX_HEIGHT="40%"
export FZF_LEGACY_KEYBINDINGS=0

export FZF_DEFAULT_OPTS="\
  --layout reverse \
  --color bg+:0,hl:0,hl+:4,fg:7,fg+:15,header:4,info:4,marker:4,pointer:4,prompt:4,spinner:4 \
"

# Prevent FFP opening multiple splits
export FPP_DISABLE_SPLIT=1

# tmuxp thing
export DISABLE_AUTO_TITLE='true'

zstyle :omz:plugins:ssh-agent agent-forwarding on
zstyle :omz:plugins:ssh-agent identities ""
zstyle :omz:plugins:ssh-agent lifetime 10m

export ZSH_TMUX_AUTOSTART="true"
export ZSH_TMUX_AUTOQUIT="false"
export ZSH_TMUX_AUTOCONNECT="false"

if [[ -f "$HOME/.dircolors" ]] && (( $+commands[gdircolors] )); then
  eval `gdircolors $HOME/.dircolors`
fi

autoload -Uz compinit
compinit

source "${HOME}/.zgen/zgen.zsh"

if ! zgen saved; then

  zgen load zsh-users/zsh-autosuggestions
  zgen load zsh-users/zsh-syntax-highlighting
  zgen oh-my-zsh lib/theme-and-appearance.zsh
  zgen oh-my-zsh lib/completion.zsh
  zgen oh-my-zsh lib/key-bindings.zsh
  zgen oh-my-zsh plugins/common-aliases
  zgen oh-my-zsh plugins/fzf
  zgen oh-my-zsh plugins/z
  zgen oh-my-zsh plugins/tmux
  zgen oh-my-zsh plugins/ssh-agent
  zgen load $ZSH_HOME/themes/kipper
  zgen load $ZSH_HOME/lib
  zgen load $ZSH_HOME/plugins

  zgen save
fi

sourceOPSession

# Need to run this after oh-my-zsh lib/completion as it resets it
# for the benefit of macOS
zstyle ':completion:*' list-colors "${(@s.:.)LS_COLORS}"

LOCAL_RC=~/.zshrc.local
if [ -e $LOCAL_RC ]; then
  source $LOCAL_RC
fi
